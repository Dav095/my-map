<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Карта O2R</title>
  <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
  <style>
    body, html { margin: 0; padding: 0; width: 100%; height: 100%; }
    #map { width: 100%; height: 100%; }
    .balloon { font-family: Arial, sans-serif; padding: 10px; max-width: 300px; }
    .balloon-title { font-weight: bold; margin-bottom: 5px; color: #1a73e8; }
    .balloon-content { font-size: 14px; }
    .balloon-row { margin-bottom: 3px; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script>
    ymaps.ready(initMap);
    
    function initMap() {
      const points = [{"coords":[60.0045,30.5708],"color":"islands#blueIcon","source":"Блок O2R","imei":860103062778643,"vehicleName":"Nissan Qashqai р961вк797","vehicleNumber":"device(imei 862430054352519, pin \"23234545\")","type":"block"},{"coords":[60.022132873535156,30.457015991210938],"color":"islands#redIcon","source":"Вышка O2R","radius":1326,"imei":860103062778643,"vehicleName":"Nissan Qashqai р961вк797","vehicleNumber":"device(imei 862430054352519, pin \"23234545\")","type":"tower"},{"coords":[55.78947067260742,37.477577209472656],"color":"islands#redIcon","source":"Вышка O2R","radius":789,"imei":860103062902300,"vehicleName":"Chery Tiggo 7 Pro о436ом797","vehicleNumber":"device(imei 860103063340658, pin \"90907878\")","type":"tower"},{"coords":[55.798,37.7132],"color":"islands#blueIcon","source":"Блок O2R","imei":860103063340658,"vehicleName":"Kia Soul м163кс797","vehicleNumber":"device(imei 862430050903315, pin \"23234545\")","type":"block"},{"coords":[55.79670715332031,37.71610641479492],"color":"islands#redIcon","source":"Вышка O2R","radius":984,"imei":860103063340658,"vehicleName":"Kia Soul м163кс797","vehicleNumber":"device(imei 862430050903315, pin \"23234545\")","type":"tower"},{"coords":[55.7082,37.7647],"color":"islands#blueIcon","source":"Блок O2R","imei":860103063609318,"vehicleName":"Kia Soul у868ка797","vehicleNumber":"device(imei 862430054305046, pin \"23234545\")","type":"block"},{"coords":[55.707611083984375,37.7650032043457],"color":"islands#redIcon","source":"Вышка O2R","radius":719,"imei":860103063609318,"vehicleName":"Kia Soul у868ка797","vehicleNumber":"device(imei 862430054305046, pin \"23234545\")","type":"tower"},{"coords":[55.79154968261719,37.52857208251953],"color":"islands#redIcon","source":"Вышка O2R","radius":997,"imei":860103063794540,"vehicleName":"Coolray (BelGee) о727тм797","vehicleNumber":"device(imei 866011051406197, pin \"45452323\")","type":"tower"},{"coords":[55.7719612121582,37.74574279785156],"color":"islands#redIcon","source":"Вышка O2R","radius":1182,"imei":861100061970469,"vehicleName":"Renault Arkana у622кт797","vehicleNumber":"device(imei 862430054353855, pin \"23234545\")","type":"tower"},{"coords":[55.83064651489258,37.4478874206543],"color":"islands#redIcon","source":"Вышка O2R","radius":477,"imei":861100067884813,"vehicleName":"Coolray (BelGee) е233то797","vehicleNumber":"device(imei 866011051818037, pin \"45452323\")","type":"tower"},{"coords":[60.0591,30.484],"color":"islands#blueIcon","source":"Блок O2R","imei":861100067955977,"vehicleName":"Chery Tiggo 7 Pro к822нв797","vehicleNumber":"device(imei 866897054228129, pin \"23234545\")","type":"block"},{"coords":[60.06005859375,30.485763549804688],"color":"islands#redIcon","source":"Вышка O2R","radius":918,"imei":861100067955977,"vehicleName":"Chery Tiggo 7 Pro к822нв797","vehicleNumber":"device(imei 866897054228129, pin \"23234545\")","type":"tower"},{"coords":[55.76639175415039,37.69984436035156],"color":"islands#redIcon","source":"Вышка O2R","radius":959,"imei":861100067956140,"vehicleName":"Changan UNI-V е292рр797","vehicleNumber":"device(imei 866011051894111, pin \"45452323\")","type":"tower"},{"coords":[55.70967102050781,37.634666442871094],"color":"islands#redIcon","source":"Вышка O2R","radius":1218,"imei":861100068007323,"vehicleName":"Coolray (BelGee) е376те797","vehicleNumber":"device(imei 866011051956324, pin \"45452323\")","type":"tower"},{"coords":[56.1708,38.6279],"color":"islands#blueIcon","source":"Блок O2R","imei":862430050888219,"vehicleName":"Nissan Qashqai т469вн797","vehicleNumber":"device(imei 862430054350182, pin \"23234545\")","type":"block"},{"coords":[55.90106964111328,38.04335403442383],"color":"islands#redIcon","source":"Вышка O2R","radius":1548,"imei":862430050888219,"vehicleName":"Nissan Qashqai т469вн797","vehicleNumber":"device(imei 862430054350182, pin \"23234545\")","type":"tower"},{"coords":[55.9758,37.4307],"color":"islands#blueIcon","source":"Блок O2R","imei":862430054305046,"vehicleName":"Kia Rio м024тх797","vehicleNumber":"device(imei 864626047756751, pin \"2014\")","type":"block"},{"coords":[55.845149993896484,37.400814056396484],"color":"islands#redIcon","source":"Вышка O2R","radius":530,"imei":862430054305046,"vehicleName":"Kia Rio м024тх797","vehicleNumber":"device(imei 864626047756751, pin \"2014\")","type":"tower"},{"coords":[55.778778076171875,37.603919982910156],"color":"islands#redIcon","source":"Вышка O2R","radius":908,"imei":862430054350901,"vehicleName":"Chery Tiggo 7 Pro к617му797","vehicleNumber":"device(imei 866897056028188, pin \"23234545\")","type":"tower"},{"coords":[55.7619514465332,37.68206787109375],"color":"islands#redIcon","source":"Вышка O2R","radius":800,"imei":862430054360611,"vehicleName":"Geely Coolray у526нх797","vehicleNumber":"device(imei 862430054378092, pin \"23234545\")","type":"tower"},{"coords":[45.098663330078125,38.973270416259766],"color":"islands#redIcon","source":"Вышка O2R","radius":674,"imei":862430054364324,"vehicleName":"Chery Tiggo 7 Pro х961нт797","vehicleNumber":"device(imei 866897054213626, pin \"23234545\")","type":"tower"},{"coords":[59.54063034057617,30.865476608276367],"color":"islands#redIcon","source":"Вышка O2R","radius":1181,"imei":862430054368598,"vehicleName":"Kia Rio а296ко797","vehicleNumber":"device(imei 864626045104160, pin \"2014\")","type":"tower"},{"coords":[55.828407287597656,37.59233474731445],"color":"islands#redIcon","source":"Вышка O2R","radius":724,"imei":862430054378183,"vehicleName":"Changan UNI-V е466рн797","vehicleNumber":"device(imei 866011051837151, pin \"45452323\")","type":"tower"},{"coords":[55.8181,37.5009],"color":"islands#blueIcon","source":"Блок O2R","imei":862430054380601,"vehicleName":"Geely Coolray р114не797","vehicleNumber":"device(imei 862430056028505, pin \"23234545\")","type":"block"},{"coords":[55.818119049072266,37.49911880493164],"color":"islands#redIcon","source":"Вышка O2R","radius":701,"imei":862430054380601,"vehicleName":"Geely Coolray р114не797","vehicleNumber":"device(imei 862430056028505, pin \"23234545\")","type":"tower"},{"coords":[55.71914291381836,37.67598342895508],"color":"islands#redIcon","source":"Вышка O2R","radius":832,"imei":862430056695329,"vehicleName":"Kia Rio н968ет797","vehicleNumber":"device(imei 862843046833141, pin \"1918\")","type":"tower"},{"coords":[55.8701,37.4611],"color":"islands#blueIcon","source":"Блок O2R","imei":862531045627859,"vehicleName":"Renault Arkana у675ех797","vehicleNumber":"device(imei 862843046791927, pin \"1918\")","type":"block"},{"coords":[55.867000579833984,37.46160125732422],"color":"islands#redIcon","source":"Вышка O2R","radius":1543,"imei":862531045627859,"vehicleName":"Renault Arkana у675ех797","vehicleNumber":"device(imei 862843046791927, pin \"1918\")","type":"tower"},{"coords":[55.79970932006836,37.708499908447266],"color":"islands#redIcon","source":"Вышка O2R","radius":919,"imei":864626045081350,"vehicleName":"Haval Jolion Elite е981вк797","vehicleNumber":"device(imei 862430054364324, pin \"23234545\")","type":"tower"},{"coords":[47.21849822998047,39.68914794921875],"color":"islands#redIcon","source":"Вышка O2R","radius":1089,"imei":864626045086342,"vehicleName":"Chery Tiggo 7 Pro к443он797","vehicleNumber":"device(imei 860103063609649, pin \"90907878\")","type":"tower"},{"coords":[55.532108306884766,37.622039794921875],"color":"islands#redIcon","source":"Вышка O2R","radius":1400,"imei":864626047756751,"vehicleName":"Coolray (BelGee) н899рр797","vehicleNumber":"device(imei 860103062915229, pin \"90907878\")","type":"tower"},{"coords":[59.8324,30.3562],"color":"islands#blueIcon","source":"Блок O2R","imei":866011051395267,"vehicleName":"Kia Rio а315кв797","vehicleNumber":"device(imei 864626045105324, pin \"2014\")","type":"block"},{"coords":[59.83427047729492,30.352602005004883],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051395267,"vehicleName":"Kia Rio а315кв797","vehicleNumber":"device(imei 864626045105324, pin \"2014\")","type":"tower"},{"coords":[55.42852020263672,37.545379638671875],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051418085,"vehicleName":"Haval Jolion Elite м149но797","vehicleNumber":"device(imei 861100067932174, pin \"90907878\")","type":"tower"},{"coords":[55.9766,37.4311],"color":"islands#blueIcon","source":"Блок O2R","imei":866011051419869,"vehicleName":"Chery Arrizo 8 а967рм797","vehicleNumber":"device(imei 866011051378610, pin \"45452323\")","type":"block"},{"coords":[55.823646545410156,37.43095779418945],"color":"islands#redIcon","source":"Вышка O2R","radius":343,"imei":866011051419869,"vehicleName":"Chery Arrizo 8 а967рм797","vehicleNumber":"device(imei 866011051378610, pin \"45452323\")","type":"tower"},{"coords":[55.747562408447266,37.59534454345703],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051430395,"vehicleName":"Geely Atlas Pro т182нт797","vehicleNumber":"device(imei 861100067884813, pin \"90907878\")","type":"tower"},{"coords":[55.9084,37.2909],"color":"islands#blueIcon","source":"Блок O2R","imei":866011051451789,"vehicleName":"Jac JS6 с288нк797","vehicleNumber":"device(imei 862430056046127, pin \"23234545\")","type":"block"},{"coords":[55.818790435791016,37.7591667175293],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051451789,"vehicleName":"Jac JS6 с288нк797","vehicleNumber":"device(imei 862430056046127, pin \"23234545\")","type":"tower"},{"coords":[55.671424865722656,37.78080749511719],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051464188,"vehicleName":"Kia Rio е467те797","vehicleNumber":"device(imei 864626045086342, pin \"2014\")","type":"tower"},{"coords":[60.03085708618164,30.29583740234375],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051851913,"vehicleName":"Changan CS55 Plus к044ов797","vehicleNumber":"device(imei 860103063274527, pin \"90907878\")","type":"tower"},{"coords":[55.742618560791016,37.66279602050781],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051903805,"vehicleName":"Chery Tiggo 7 Pro т201ов797","vehicleNumber":"device(imei 860103063794540, pin \"90907878\")","type":"tower"},{"coords":[55.89248275756836,38.006370544433594],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051903912,"vehicleName":"Geely Coolray у518нх797","vehicleNumber":"device(imei 862430054378183, pin \"23234545\")","type":"tower"},{"coords":[55.74080276489258,37.50205612182617],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051923266,"vehicleName":"Chery Tiggo 7 Pro т134му797","vehicleNumber":"device(imei 862430050908082, pin \"23234545\")","type":"tower"},{"coords":[55.74794387817383,37.704463958740234],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051926970,"vehicleName":"Changan UNI-S р811ту797","vehicleNumber":"device(imei 866011051841500, pin \"45452323\")","type":"tower"},{"coords":[55.66341781616211,37.77751922607422],"color":"islands#redIcon","source":"Вышка O2R","radius":328,"imei":866011051956118,"vehicleName":"Haval Jolion Elite т998нр797","vehicleNumber":"device(imei 861100067955977, pin \"90907878\")","type":"tower"},{"coords":[55.7907,37.7519],"color":"islands#blueIcon","source":"Блок O2R","imei":866011052010055,"vehicleName":"Kia Rio р103кн797","vehicleNumber":"device(imei 864626047731366, pin \"2014\")","type":"block"},{"coords":[55.7881965637207,37.75299835205078],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011052010055,"vehicleName":"Kia Rio р103кн797","vehicleNumber":"device(imei 864626047731366, pin \"2014\")","type":"tower"},{"coords":[55.75831604003906,37.64072799682617],"color":"islands#redIcon","source":"Вышка O2R","radius":755,"imei":866897054151669,"vehicleName":"VW Tiguan к767кв797","vehicleNumber":"device(imei 862549046253954, pin \"1918\")","type":"tower"},{"coords":[55.56044006347656,38.116024017333984],"color":"islands#redIcon","source":"Вышка O2R","radius":563,"imei":866897056030994,"vehicleName":"Nissan Qashqai в417кр797","vehicleNumber":"device(imei 864626045068365, pin \"2014\")","type":"tower"},{"coords":[55.975,37.4309],"color":"islands#blueIcon","source":"Блок O2R","imei":869627030156533,"vehicleName":"Kia Rio а569кр797","vehicleNumber":"device(imei 864626045104244, pin \"2014\")","type":"block"},{"coords":[55.82767105102539,37.42493438720703],"color":"islands#redIcon","source":"Вышка O2R","radius":792,"imei":869627030156533,"vehicleName":"Kia Rio а569кр797","vehicleNumber":"device(imei 864626045104244, pin \"2014\")","type":"tower"}];
      const map = new ymaps.Map("map", {
        center: [55.751574, 37.573856],
        zoom: 10
      });
      
      // Добавляем точки на карту
      points.forEach(point => {
        const placemark = new ymaps.Placemark(
          point.coords,
          {
            balloonContentHeader: '<div class="balloon-title">' + point.source + '</div>',
            balloonContentBody: `
              <div class="balloon">
                <div class="balloon-row"><strong>IMEI:</strong> ${point.imei}</div>
                ${point.vehicleName ? '<div class="balloon-row"><strong>Машина:</strong> ' + point.vehicleName + '</div>' : ''}
                ${point.radius ? '<div class="balloon-row"><strong>Точность:</strong> ' + point.radius + ' м</div>' : ''}
                <div class="balloon-row"><strong>Координаты:</strong> ${point.coords[0].toFixed(6)}, ${point.coords[1].toFixed(6)}</div>
              </div>
            `,
            hintContent: point.source
          },
          {
            preset: point.color,
            balloonCloseButton: true,
            balloonMaxWidth: 300
          }
        );
        
        // Для вышек добавляем круг точности
        if (point.radius && point.type === "tower") {
          const circle = new ymaps.Circle([
            point.coords,
            point.radius
          ], {}, {
            fillColor: "#FF0000",
            fillOpacity: 0.1,
            strokeColor: "#FF0000",
            strokeOpacity: 0.8,
            strokeWidth: 2
          });
          map.geoObjects.add(circle);
        }
        
        map.geoObjects.add(placemark);
      });
      
      // Автоматически подбираем масштаб и центр
      if (points.length > 0) {
        map.setBounds(map.geoObjects.getBounds(), { checkZoomRange: true });
      }
    }
  </script>
</body>
</html>