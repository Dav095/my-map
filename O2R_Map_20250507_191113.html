<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Карта O2R</title>
  <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
  <style>
    body, html { margin: 0; padding: 0; width: 100%; height: 100%; }
    #map { width: 100%; height: 100%; }
    .balloon { font-family: Arial, sans-serif; padding: 10px; max-width: 300px; }
    .balloon-title { font-weight: bold; margin-bottom: 5px; color: #1a73e8; }
    .balloon-content { font-size: 14px; }
    .balloon-row { margin-bottom: 3px; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script>
    ymaps.ready(initMap);
    
    function initMap() {
      const points = [{"coords":[55.78498458862305,37.54023361206055],"color":"islands#redIcon","source":"Вышка O2R","radius":906,"imei":860103062834115,"vehicleName":"Nissan Qashqai р961вк797","vehicleNumber":"device(imei 862430054352519, pin \"23234545\")","type":"tower"},{"coords":[55.64331817626953,37.757476806640625],"color":"islands#redIcon","source":"Вышка O2R","radius":988,"imei":860103062903076,"vehicleName":"Chery Tiggo 7 Pro о436ом797","vehicleNumber":"device(imei 860103063340658, pin \"90907878\")","type":"tower"},{"coords":[55.9178,38.0034],"color":"islands#blueIcon","source":"Блок O2R","imei":860103063609649,"vehicleName":"Kia Soul у868ка797","vehicleNumber":"device(imei 862430054305046, pin \"23234545\")","type":"block"},{"coords":[55.91413497924805,38.006736755371094],"color":"islands#redIcon","source":"Вышка O2R","radius":830,"imei":860103063609649,"vehicleName":"Kia Soul у868ка797","vehicleNumber":"device(imei 862430054305046, pin \"23234545\")","type":"tower"},{"coords":[55.7395133972168,37.656494140625],"color":"islands#redIcon","source":"Вышка O2R","radius":607,"imei":860103064148902,"vehicleName":"Coolray (BelGee) о727тм797","vehicleNumber":"device(imei 866011051406197, pin \"45452323\")","type":"tower"},{"coords":[55.85616683959961,37.551788330078125],"color":"islands#redIcon","source":"Вышка O2R","radius":1222,"imei":861100067947982,"vehicleName":"Renault Arkana у622кт797","vehicleNumber":"device(imei 862430054353855, pin \"23234545\")","type":"tower"},{"coords":[60.0591,30.484],"color":"islands#blueIcon","source":"Блок O2R","imei":861100067955977,"vehicleName":"Coolray (BelGee) е233то797","vehicleNumber":"device(imei 866011051818037, pin \"45452323\")","type":"block"},{"coords":[60.06005859375,30.485763549804688],"color":"islands#redIcon","source":"Вышка O2R","radius":918,"imei":861100067955977,"vehicleName":"Coolray (BelGee) е233то797","vehicleNumber":"device(imei 866011051818037, pin \"45452323\")","type":"tower"},{"coords":[55.70967102050781,37.634666442871094],"color":"islands#redIcon","source":"Вышка O2R","radius":1218,"imei":861100068007323,"vehicleName":"Chery Tiggo 7 Pro к822нв797","vehicleNumber":"device(imei 866897054228129, pin \"23234545\")","type":"tower"},{"coords":[59.53733444213867,30.880985260009766],"color":"islands#redIcon","source":"Вышка O2R","radius":1045,"imei":862430050136924,"vehicleName":"Changan UNI-V е292рр797","vehicleNumber":"device(imei 866011051894111, pin \"45452323\")","type":"tower"},{"coords":[55.7824,37.7357],"color":"islands#blueIcon","source":"Блок O2R","imei":862430050887559,"vehicleName":"Coolray (BelGee) е376те797","vehicleNumber":"device(imei 866011051956324, pin \"45452323\")","type":"block"},{"coords":[55.785091400146484,37.73878479003906],"color":"islands#redIcon","source":"Вышка O2R","radius":1408,"imei":862430050887559,"vehicleName":"Coolray (BelGee) е376те797","vehicleNumber":"device(imei 866011051956324, pin \"45452323\")","type":"tower"},{"coords":[55.8787,37.4225],"color":"islands#blueIcon","source":"Блок O2R","imei":862430054302621,"vehicleName":"Nissan Qashqai т469вн797","vehicleNumber":"device(imei 862430054350182, pin \"23234545\")","type":"block"},{"coords":[55.87948989868164,37.4234619140625],"color":"islands#redIcon","source":"Вышка O2R","radius":1181,"imei":862430054302621,"vehicleName":"Nissan Qashqai т469вн797","vehicleNumber":"device(imei 862430054350182, pin \"23234545\")","type":"tower"},{"coords":[55.9381,37.9838],"color":"islands#blueIcon","source":"Блок O2R","imei":862430054352519,"vehicleName":"Kia Rio м024тх797","vehicleNumber":"device(imei 864626047756751, pin \"2014\")","type":"block"},{"coords":[55.93784713745117,37.9808464050293],"color":"islands#redIcon","source":"Вышка O2R","radius":927,"imei":862430054352519,"vehicleName":"Kia Rio м024тх797","vehicleNumber":"device(imei 864626047756751, pin \"2014\")","type":"tower"},{"coords":[55.7619514465332,37.68206787109375],"color":"islands#redIcon","source":"Вышка O2R","radius":800,"imei":862430054360611,"vehicleName":"Chery Tiggo 7 Pro к617му797","vehicleNumber":"device(imei 866897056028188, pin \"23234545\")","type":"tower"},{"coords":[59.54063034057617,30.865476608276367],"color":"islands#redIcon","source":"Вышка O2R","radius":1181,"imei":862430054368598,"vehicleName":"Geely Coolray у526нх797","vehicleNumber":"device(imei 862430054378092, pin \"23234545\")","type":"tower"},{"coords":[55.79538345336914,37.54390335083008],"color":"islands#redIcon","source":"Вышка O2R","radius":1178,"imei":862430054370339,"vehicleName":"Coolray (BelGee) р932ро797","vehicleNumber":"device(imei 860103063102033, pin \"90907878\")","type":"tower"},{"coords":[55.828407287597656,37.59233474731445],"color":"islands#redIcon","source":"Вышка O2R","radius":724,"imei":862430054378183,"vehicleName":"Chery Tiggo 7 Pro х961нт797","vehicleNumber":"device(imei 866897054213626, pin \"23234545\")","type":"tower"},{"coords":[55.8181,37.5009],"color":"islands#blueIcon","source":"Блок O2R","imei":862430054380601,"vehicleName":"Kia Rio а296ко797","vehicleNumber":"device(imei 864626045104160, pin \"2014\")","type":"block"},{"coords":[55.818119049072266,37.49911880493164],"color":"islands#redIcon","source":"Вышка O2R","radius":701,"imei":862430054380601,"vehicleName":"Kia Rio а296ко797","vehicleNumber":"device(imei 864626045104160, pin \"2014\")","type":"tower"},{"coords":[55.7728,37.4656],"color":"islands#blueIcon","source":"Блок O2R","imei":862430056028505,"vehicleName":"Changan UNI-V е466рн797","vehicleNumber":"device(imei 866011051837151, pin \"45452323\")","type":"block"},{"coords":[55.772727966308594,37.46617126464844],"color":"islands#redIcon","source":"Вышка O2R","radius":723,"imei":862430056028505,"vehicleName":"Changan UNI-V е466рн797","vehicleNumber":"device(imei 866011051837151, pin \"45452323\")","type":"tower"},{"coords":[55.802589416503906,37.636192321777344],"color":"islands#redIcon","source":"Вышка O2R","radius":1188,"imei":862430056028968,"vehicleName":"Geely Coolray р114не797","vehicleNumber":"device(imei 862430056028505, pin \"23234545\")","type":"tower"},{"coords":[59.6279,30.3996],"color":"islands#blueIcon","source":"Блок O2R","imei":862531047192019,"vehicleName":"Kia Rio н968ет797","vehicleNumber":"device(imei 862843046833141, pin \"1918\")","type":"block"},{"coords":[59.62596893310547,30.386934280395508],"color":"islands#redIcon","source":"Вышка O2R","radius":1583,"imei":862531047192019,"vehicleName":"Kia Rio н968ет797","vehicleNumber":"device(imei 862843046833141, pin \"1918\")","type":"tower"},{"coords":[55.68251037597656,37.2869758605957],"color":"islands#redIcon","source":"Вышка O2R","radius":842,"imei":864626047734972,"vehicleName":"Haval Jolion Elite е981вк797","vehicleNumber":"device(imei 862430054364324, pin \"23234545\")","type":"tower"},{"coords":[47.228416442871094,39.7120475769043],"color":"islands#redIcon","source":"Вышка O2R","radius":615,"imei":864626047747420,"vehicleName":"Chery Tiggo 7 Pro к443он797","vehicleNumber":"device(imei 860103063609649, pin \"90907878\")","type":"tower"},{"coords":[55.7374,37.5397],"color":"islands#blueIcon","source":"Блок O2R","imei":866011051405280,"vehicleName":"Coolray (BelGee) н899рр797","vehicleNumber":"device(imei 860103062915229, pin \"90907878\")","type":"block"},{"coords":[55.73832321166992,37.53662872314453],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051405280,"vehicleName":"Coolray (BelGee) н899рр797","vehicleNumber":"device(imei 860103062915229, pin \"90907878\")","type":"tower"},{"coords":[59.5430793762207,30.864215850830078],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051425767,"vehicleName":"Kia Rio а315кв797","vehicleNumber":"device(imei 864626045105324, pin \"2014\")","type":"tower"},{"coords":[55.747562408447266,37.59534454345703],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051430395,"vehicleName":"Exeed LX р202му797","vehicleNumber":"device(imei 866897052362508, pin \"23234545\")","type":"tower"},{"coords":[55.686336517333984,37.6644172668457],"color":"islands#redIcon","source":"Вышка O2R","radius":807,"imei":866011051442275,"vehicleName":"Haval Jolion Elite м149но797","vehicleNumber":"device(imei 861100067932174, pin \"90907878\")","type":"tower"},{"coords":[55.776451110839844,37.58454513549805],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051451359,"vehicleName":"Chery Arrizo 8 а967рм797","vehicleNumber":"device(imei 866011051378610, pin \"45452323\")","type":"tower"},{"coords":[55.81420135498047,37.742679595947266],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051452068,"vehicleName":"Geely Atlas Pro т182нт797","vehicleNumber":"device(imei 861100067884813, pin \"90907878\")","type":"tower"},{"coords":[55.53866958618164,37.617801666259766],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051465433,"vehicleName":"Jac JS6 с288нк797","vehicleNumber":"device(imei 862430056046127, pin \"23234545\")","type":"tower"},{"coords":[60.03085708618164,30.29583740234375],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011051851913,"vehicleName":"Kia Rio е467те797","vehicleNumber":"device(imei 864626045086342, pin \"2014\")","type":"tower"},{"coords":[55.66341781616211,37.77751922607422],"color":"islands#redIcon","source":"Вышка O2R","radius":328,"imei":866011051956118,"vehicleName":"Changan CS55 Plus к044ов797","vehicleNumber":"device(imei 860103063274527, pin \"90907878\")","type":"tower"},{"coords":[55.7907,37.7519],"color":"islands#blueIcon","source":"Блок O2R","imei":866011052010055,"vehicleName":"Chery Tiggo 7 Pro т201ов797","vehicleNumber":"device(imei 860103063794540, pin \"90907878\")","type":"block"},{"coords":[55.7881965637207,37.75299835205078],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011052010055,"vehicleName":"Chery Tiggo 7 Pro т201ов797","vehicleNumber":"device(imei 860103063794540, pin \"90907878\")","type":"tower"},{"coords":[55.6536865234375,37.836734771728516],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011052038338,"vehicleName":"Geely Coolray у518нх797","vehicleNumber":"device(imei 862430054378183, pin \"23234545\")","type":"tower"},{"coords":[55.4266,37.7561],"color":"islands#blueIcon","source":"Блок O2R","imei":866011052042934,"vehicleName":"Chery Tiggo 7 Pro т134му797","vehicleNumber":"device(imei 862430050908082, pin \"23234545\")","type":"block"},{"coords":[55.4256477355957,37.75838851928711],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011052042934,"vehicleName":"Chery Tiggo 7 Pro т134му797","vehicleNumber":"device(imei 862430050908082, pin \"23234545\")","type":"tower"},{"coords":[55.8424,37.3554],"color":"islands#blueIcon","source":"Блок O2R","imei":866011052340270,"vehicleName":"Changan UNI-S р811ту797","vehicleNumber":"device(imei 866011051841500, pin \"45452323\")","type":"block"},{"coords":[55.842899322509766,37.357421875],"color":"islands#redIcon","source":"Вышка O2R","radius":131,"imei":866011052340270,"vehicleName":"Changan UNI-S р811ту797","vehicleNumber":"device(imei 866011051841500, pin \"45452323\")","type":"tower"},{"coords":[55.75831604003906,37.64072799682617],"color":"islands#redIcon","source":"Вышка O2R","radius":755,"imei":866897054151669,"vehicleName":"Haval Jolion Elite т998нр797","vehicleNumber":"device(imei 861100067955977, pin \"90907878\")","type":"tower"},{"coords":[55.7063,37.6962],"color":"islands#blueIcon","source":"Блок O2R","imei":866897054213626,"vehicleName":"Kia Rio р103кн797","vehicleNumber":"device(imei 864626047731366, pin \"2014\")","type":"block"},{"coords":[55.70378112792969,37.69587707519531],"color":"islands#redIcon","source":"Вышка O2R","radius":1409,"imei":866897054213626,"vehicleName":"Kia Rio р103кн797","vehicleNumber":"device(imei 864626047731366, pin \"2014\")","type":"tower"}];
      const map = new ymaps.Map("map", {
        center: [55.751574, 37.573856],
        zoom: 10
      });
      
      // Добавляем точки на карту
      points.forEach(point => {
        const placemark = new ymaps.Placemark(
          point.coords,
          {
            balloonContentHeader: '<div class="balloon-title">' + point.source + '</div>',
            balloonContentBody: `
              <div class="balloon">
                ${point.vehicleName ? '<div class="balloon-row"><strong>Машина:</strong> ' + point.vehicleName + '</div>' : ''}
                ${point.radius ? '<div class="balloon-row"><strong>Точность:</strong> ' + point.radius + ' м</div>' : ''}
                <div class="balloon-row"><strong>Координаты:</strong> ${point.coords[0].toFixed(6)}, ${point.coords[1].toFixed(6)}</div>
              </div>
            `,
            hintContent: point.source
          },
          {
            preset: point.color,
            balloonCloseButton: true,
            balloonMaxWidth: 300
          }
        );
        
        // Для вышек добавляем круг точности
        if (point.radius && point.type === "tower") {
          const circle = new ymaps.Circle([
            point.coords,
            point.radius
          ], {}, {
            fillColor: "#FF0000",
            fillOpacity: 0.1,
            strokeColor: "#FF0000",
            strokeOpacity: 0.8,
            strokeWidth: 2
          });
          map.geoObjects.add(circle);
        }
        
        map.geoObjects.add(placemark);
      });
      
      // Автоматически подбираем масштаб и центр
      if (points.length > 0) {
        map.setBounds(map.geoObjects.getBounds(), { checkZoomRange: true });
      }
    }
  </script>
</body>
</html>