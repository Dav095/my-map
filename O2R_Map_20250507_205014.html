<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>????? O2R</title>
  <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
  <style>
    body, html { margin: 0; padding: 0; width: 100%; height: 100%; }
    #map { width: 100%; height: 100%; }
    .balloon { font-family: Arial, sans-serif; padding: 10px; max-width: 300px; }
    .balloon-title { font-weight: bold; margin-bottom: 5px; color: #1a73e8; }
    .balloon-content { font-size: 14px; }
    .balloon-row { margin-bottom: 3px; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script>
    ymaps.ready(initMap);
    
    function initMap() {
      const points = [{"coords":[55.9805,37.4266],"color":"islands#blueIcon","source":"???? O2R","imei":860103062903571,"vehicleName":"Nissan Qashqai ?961??797","pin":"","type":"block","gpsInView":14},{"coords":[55.83660888671875,37.346412658691406],"color":"islands#redIcon","source":"????? O2R","radius":1552,"imei":860103062903571,"vehicleName":"Nissan Qashqai ?961??797","pin":"","type":"tower","gpsInView":14},{"coords":[55.6576,37.208],"color":"islands#blueIcon","source":"???? O2R","imei":860103063060082,"vehicleName":"Chery Arrizo 8 ?050??797","pin":"","type":"block","gpsInView":12},{"coords":[55.660301208496094,37.2093620300293],"color":"islands#redIcon","source":"????? O2R","radius":768,"imei":860103063060082,"vehicleName":"Chery Arrizo 8 ?050??797","pin":"","type":"tower","gpsInView":12},{"coords":[55.69313430786133,37.628292083740234],"color":"islands#redIcon","source":"????? O2R","radius":1538,"imei":860103063140108,"vehicleName":"Chery Tiggo 7 Pro ?436??797","pin":"","type":"tower","gpsInView":5},{"coords":[59.7855,30.1463],"color":"islands#blueIcon","source":"???? O2R","imei":860103063257274,"vehicleName":"Chery Tiggo 7 Pro ?890??797","pin":"","type":"block","gpsInView":13},{"coords":[59.78374099731445,30.14215850830078],"color":"islands#redIcon","source":"????? O2R","radius":1406,"imei":860103063257274,"vehicleName":"Chery Tiggo 7 Pro ?890??797","pin":"","type":"tower","gpsInView":13},{"coords":[55.770957946777344,37.543304443359375],"color":"islands#redIcon","source":"????? O2R","radius":679,"imei":860103063739057,"vehicleName":"Kia Soul ?868??797","pin":"","type":"tower","gpsInView":4},{"coords":[55.42818832397461,37.55061721801758],"color":"islands#redIcon","source":"????? O2R","radius":1110,"imei":861100067930509,"vehicleName":"Coolray (BelGee) ?727??797","pin":"","type":"tower","gpsInView":""},{"coords":[59.98893737792969,29.7731990814209],"color":"islands#redIcon","source":"????? O2R","radius":908,"imei":861100067930954,"vehicleName":"Chery Tiggo 7 Pro ?152??797","pin":"","type":"tower","gpsInView":""},{"coords":[55.9801,37.4247],"color":"islands#blueIcon","source":"???? O2R","imei":862430050893953,"vehicleName":"Renault Arkana ?622??797","pin":"","type":"block","gpsInView":13},{"coords":[55.83464813232422,37.458675384521484],"color":"islands#redIcon","source":"????? O2R","radius":894,"imei":862430050893953,"vehicleName":"Renault Arkana ?622??797","pin":"","type":"tower","gpsInView":13},{"coords":[55.77983474731445,37.65988540649414],"color":"islands#redIcon","source":"????? O2R","radius":642,"imei":862430050900006,"vehicleName":"Changan UNI-V ?292??797","pin":"","type":"tower","gpsInView":8},{"coords":[60.09272384643555,30.38020896911621],"color":"islands#redIcon","source":"????? O2R","radius":883,"imei":862430054239443,"vehicleName":"Coolray (BelGee) ?376??797","pin":"","type":"tower","gpsInView":""},{"coords":[55.75955581665039,37.67695617675781],"color":"islands#redIcon","source":"????? O2R","radius":846,"imei":862430054312554,"vehicleName":"Nissan Qashqai ?469??797","pin":"","type":"tower","gpsInView":2},{"coords":[55.80712127685547,37.747501373291016],"color":"islands#redIcon","source":"????? O2R","radius":1145,"imei":862430054364613,"vehicleName":"Jac JS4 ?013??797","pin":"","type":"tower","gpsInView":10},{"coords":[59.54063034057617,30.865476608276367],"color":"islands#redIcon","source":"????? O2R","radius":1181,"imei":862430054368598,"vehicleName":"Kia Rio ?024??797","pin":"","type":"tower","gpsInView":""},{"coords":[47.2406005859375,39.7585563659668],"color":"islands#redIcon","source":"????? O2R","radius":904,"imei":862430054381435,"vehicleName":"Geely Coolray ?526??797","pin":"","type":"tower","gpsInView":3},{"coords":[55.81719207763672,37.347991943359375],"color":"islands#redIcon","source":"????? O2R","radius":873,"imei":862430055911180,"vehicleName":"Kia Sportage ?896??797","pin":"","type":"tower","gpsInView":4},{"coords":[55.59806823730469,37.62339401245117],"color":"islands#redIcon","source":"????? O2R","radius":975,"imei":862430056710102,"vehicleName":"Chery Tiggo 7 Pro ?961??797","pin":"","type":"tower","gpsInView":7},{"coords":[55.7855224609375,37.59520721435547],"color":"islands#redIcon","source":"????? O2R","radius":867,"imei":862430056737667,"vehicleName":"Kia Rio ?296??797","pin":"","type":"tower","gpsInView":3},{"coords":[55.5319709777832,37.639015197753906],"color":"islands#redIcon","source":"????? O2R","radius":799,"imei":862531047177622,"vehicleName":"Changan UNI-V ?466??797","pin":"","type":"tower","gpsInView":12},{"coords":[59.6279,30.3996],"color":"islands#blueIcon","source":"???? O2R","imei":862531047192019,"vehicleName":"Geely Coolray ?114??797","pin":"","type":"block","gpsInView":13},{"coords":[59.62552261352539,30.39401626586914],"color":"islands#redIcon","source":"????? O2R","radius":1251,"imei":862531047192019,"vehicleName":"Geely Coolray ?114??797","pin":"","type":"tower","gpsInView":13},{"coords":[55.68251037597656,37.2869758605957],"color":"islands#redIcon","source":"????? O2R","radius":842,"imei":864626047734972,"vehicleName":"Kia Rio ?968??797","pin":"","type":"tower","gpsInView":11},{"coords":[55.686336517333984,37.6644172668457],"color":"islands#redIcon","source":"????? O2R","radius":807,"imei":866011051442275,"vehicleName":"Haval Jolion Elite ?981??797","pin":"","type":"tower","gpsInView":20},{"coords":[55.8137,37.7463],"color":"islands#blueIcon","source":"???? O2R","imei":866011051451789,"vehicleName":"Chery Tiggo 7 Pro ?443??797","pin":"","type":"block","gpsInView":14},{"coords":[55.818790435791016,37.7591667175293],"color":"islands#redIcon","source":"????? O2R","radius":131,"imei":866011051451789,"vehicleName":"Chery Tiggo 7 Pro ?443??797","pin":"","type":"tower","gpsInView":14},{"coords":[55.80247116088867,37.59564971923828],"color":"islands#redIcon","source":"????? O2R","radius":268,"imei":866011051460749,"vehicleName":"Coolray (BelGee) ?899??797","pin":"","type":"tower","gpsInView":18},{"coords":[55.8432,37.5835],"color":"islands#blueIcon","source":"???? O2R","imei":866011051464477,"vehicleName":"Kia Rio ?315??797","pin":"","type":"block","gpsInView":11},{"coords":[55.84185791015625,37.58235168457031],"color":"islands#redIcon","source":"????? O2R","radius":387,"imei":866011051464477,"vehicleName":"Kia Rio ?315??797","pin":"","type":"tower","gpsInView":11},{"coords":[55.8206,37.3728],"color":"islands#blueIcon","source":"???? O2R","imei":866011051464733,"vehicleName":"Exeed LX ?202??797","pin":"","type":"block","gpsInView":12},{"coords":[55.82137680053711,37.37149429321289],"color":"islands#redIcon","source":"????? O2R","radius":131,"imei":866011051464733,"vehicleName":"Exeed LX ?202??797","pin":"","type":"tower","gpsInView":12},{"coords":[55.81974792480469,37.758689880371094],"color":"islands#redIcon","source":"????? O2R","radius":131,"imei":866011051465375,"vehicleName":"Haval Jolion Elite ?149??797","pin":"","type":"tower","gpsInView":18},{"coords":[55.6661262512207,37.85787582397461],"color":"islands#redIcon","source":"????? O2R","radius":131,"imei":866011051806735,"vehicleName":"Chery Arrizo 8 ?967??797","pin":"","type":"tower","gpsInView":19},{"coords":[55.7791,37.467],"color":"islands#blueIcon","source":"???? O2R","imei":866011051825982,"vehicleName":"Geely Atlas Pro ?182??797","pin":"","type":"block","gpsInView":13},{"coords":[55.775596618652344,37.4717903137207],"color":"islands#redIcon","source":"????? O2R","radius":131,"imei":866011051825982,"vehicleName":"Geely Atlas Pro ?182??797","pin":"","type":"tower","gpsInView":13},{"coords":[60.030792236328125,30.29691505432129],"color":"islands#redIcon","source":"????? O2R","radius":131,"imei":866011051851913,"vehicleName":"Jac JS6 ?288??797","pin":"","type":"tower","gpsInView":""},{"coords":[55.797000885009766,37.74308395385742],"color":"islands#redIcon","source":"????? O2R","radius":131,"imei":866011051868016,"vehicleName":"Geely Coolray New ?547??797","pin":"","type":"tower","gpsInView":21},{"coords":[55.9801,37.4261],"color":"islands#blueIcon","source":"???? O2R","imei":866011051903961,"vehicleName":"Kia Rio ?467??797","pin":"","type":"block","gpsInView":13},{"coords":[55.825435638427734,37.424415588378906],"color":"islands#redIcon","source":"????? O2R","radius":466,"imei":866011051903961,"vehicleName":"Kia Rio ?467??797","pin":"","type":"tower","gpsInView":13},{"coords":[55.71162033081055,37.64299392700195],"color":"islands#redIcon","source":"????? O2R","radius":131,"imei":866011051954626,"vehicleName":"Chery Tiggo 7 Pro ?049??797","pin":"","type":"tower","gpsInView":16},{"coords":[55.7907829284668,37.59955596923828],"color":"islands#redIcon","source":"????? O2R","radius":131,"imei":866011052367190,"vehicleName":"Exeed LX ?601??797","pin":"","type":"tower","gpsInView":19},{"coords":[55.80754852294922,37.72639083862305],"color":"islands#redIcon","source":"????? O2R","radius":951,"imei":866897054181864,"vehicleName":"Changan CS55 Plus ?044??797","pin":"","type":"tower","gpsInView":10},{"coords":[55.6768,37.7008],"color":"islands#blueIcon","source":"???? O2R","imei":866897054228715,"vehicleName":"Chery Tiggo 7 Pro ?201??797","pin":"","type":"block","gpsInView":12},{"coords":[55.67864227294922,37.691307067871094],"color":"islands#redIcon","source":"????? O2R","radius":724,"imei":866897054228715,"vehicleName":"Chery Tiggo 7 Pro ?201??797","pin":"","type":"tower","gpsInView":12},{"coords":[55.56044006347656,38.116024017333984],"color":"islands#redIcon","source":"????? O2R","radius":563,"imei":866897056030994,"vehicleName":"Geely Coolray ?518??797","pin":"","type":"tower","gpsInView":""},{"coords":[59.540992736816406,30.876140594482422],"color":"islands#redIcon","source":"????? O2R","radius":856,"imei":866897056034434,"vehicleName":"Chery Tiggo 7 Pro ?134??797","pin":"","type":"tower","gpsInView":3},{"coords":[55.91413116455078,37.84501647949219],"color":"islands#redIcon","source":"????? O2R","radius":1202,"imei":866897056059647,"vehicleName":"Changan UNI-S ?811??797","pin":"","type":"tower","gpsInView":15}];
      const map = new ymaps.Map("map", {
        center: [55.751574, 37.573856],
        zoom: 10
      });
      
      points.forEach(function(point) {
        const balloonContent = [
          '<div class="balloon">',
          '<div class="balloon-title">' + point.source + '</div>',
          point.vehicleName ? '<div class="balloon-row"><strong>??????:</strong> ' + point.vehicleName + '</div>' : '',
          point.pin ? '<div class="balloon-row"><strong>??????????:</strong> device(imei ' + point.imei + ', pin "' + point.pin + '")</div>' : '',
          point.imei ? '<div class="balloon-row"><strong>IMEI:</strong> ' + point.imei + '</div>' : '',
          point.radius ? '<div class="balloon-row"><strong>????????:</strong> ' + point.radius + ' ?</div>' : '',
          point.gpsInView ? '<div class="balloon-row"><strong>??????? ?????????:</strong> ' + point.gpsInView + '</div>' : '',
          '<div class="balloon-row"><strong>??????????:</strong> ' + point.coords[0].toFixed(6) + ', ' + point.coords[1].toFixed(6) + '</div>',
          '</div>'
        ].join('');
        
        const placemark = new ymaps.Placemark(
          point.coords,
          {
            balloonContentHeader: '<div class="balloon-title">' + point.source + '</div>',
            balloonContentBody: balloonContent,
            hintContent: point.source
          },
          {
            preset: point.color,
            balloonCloseButton: true,
            balloonMaxWidth: 300
          }
        );
        
        if (point.radius && point.type === "tower") {
          const circle = new ymaps.Circle([
            point.coords,
            point.radius
          ], {}, {
            fillColor: "#FF0000",
            fillOpacity: 0.1,
            strokeColor: "#FF0000",
            strokeOpacity: 0.8,
            strokeWidth: 2
          });
          map.geoObjects.add(circle);
        }
        
        map.geoObjects.add(placemark);
      });
      
      if (points.length > 0) {
        map.setBounds(map.geoObjects.getBounds(), { checkZoomRange: true });
      }
    }
  </script>
</body>
</html>